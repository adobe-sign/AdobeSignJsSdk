# Table of contents
  - [Adobe Sign API NodeJs SDK](#adobe-sign-api-nodeJs-sdk)  
  - [Overview](#overview)
  - [Table of contents](#table-of-contents)  
  - [Prerequisites](#prerequisites)  
  - [Third party dependencies](#third-party-dependencies)  
  - [Getting Started](#getting-started)  
  - [Downloading and Installing the SDK](#downloading-and-installing-the-sdk)  
  - [APIs](#apis)    
  - [Samples](#samples)  
     -  [Running the Samples](#running-the-samples)
  - [Tests](#tests)  
    - [Executing the tests](#executing-the-tests) 
  - [Documentation](#documentation)    
  - [Report Issues/Bugs](#report-issuesbugs)    

# Adobe Sign API NodeJs SDK

# Overview
Adobe Sign SDK aims at providing an easy way to integrate the Adobe Sign RESTful web service into client applications through easy to consume client side objects wrapping the REST API functionality. This repository contains Adobe Signâ€™s SDK in NodeJs and samples for these APIs.

Prerequisites
====================
For the NodeJs-based SDK, the client machine should have the following software installed:
*   OS: Windows/Mac/Linux
*   NodeJs: 6.2.0 version 
*   NPM: 3.8.9 version

Third party dependencies
====================
The SDK incorporates the following third party libraries:  
* superagent:1.7.1
* validator:5.6.0
* fs:0.0.1-security

Getting Started
====================
The Adobe Sign clients need to follow the below steps in order to get started with it:

1.  In order to use the SDK, you need to have an account with Adobe Sign. Please register for a developer account [here](https://www.adobe.com/go/esign-dev-create).

2.  Sign in to create an application on the Adobe Sign web portal and obtain it's application/client id and client secret.  

3.  Generate the OAuth access token by using the above application id and the application secret. The access token will need to be generated by using the OAuth APIs. The `AdobeSignNodeJsSdk/rest-api-sdk/src/api/OAuthApi` folder contains the OAuth APIs. 

4.  Use the generated OAuth access token for trying out the sample API code (or directly in the client application code) provided in the SDK.  

Downloading and Installing the SDK
==================================

**Note :** `AdobeSignNodeJsSdk` will be referred to as the root directory for the SDK. 
 
SDK can be installed in following ways:

1. Install the client directly from npm:  `npm install adobe-sign-sdk --save`

2. Download the SDK source code zip from the GitHub and unzip the archive to a folder of your choice. You can also sync the git repo on your local machine. 
   You can find the SDK [here](https://github.com/adobe-sign/AdobeSignNodeJsSdk.git).
   Run npm install at the root directory to resolve dependencies as follows:
    `npm install`
    
APIs
====================
The `AdobeSignNodeJsSdk/rest-api-sdk/src` folder contains all the Adobe Sign APIs. 

Folders containing APIs are laid out as follows:  

**api**    
Each class represents a resource and the class methods refers to the operations that can be performed on that resource. Each such operation is called API.   
e.g. `AgreementsApi.js` contains `getAgreements` method which retrieves all the agreements for the user.  

**model**    
Each class represents request or response class required in the API calls.  
The classes are resource specific and can be found under the folders for the corresponding resources. 

**utils**    
This folder contains the helper utilities required for the execution of APIs. 

Samples
====================
**Note :** If you have installed the client from npm, please find the samples [here](https://github.com/adobe-sign/AdobeSignNodeJsSdk/tree/master/rest-api-sample).

The samples are located at : `AdobeSignNodeJsSdk/rest-api-sample`.  
These contain nodeJs clients of Adobe Sign's APIs that 
demonstrate how to use the API as well as some of its capabilities. 

Folders under samples are laid out as follows:  

**api**  
Contains individual sample clients each demonstrating a specific capability. Each 
client is named according to the capability it demonstrates. For example, the client 
GetUsersInAccount.js shows how to retrieve a list of users from the account of 
the user on whose behalf the API call is made.

**api/oAuth/server**  
Contains sample client demonstrating how to create a new group in an account by using the OAuth workflow.
**Note :** It also contains a OAuthReadMe file which describes how the user can use this sample. 

**utils**  
Contains helper classes that encapsulate the API calls required by the sample clients.

**resources**  
Contains input files used by the sample clients. These include a config.json file and pdf files required by some of the APIs.


### Running the Samples

**Note :** Before executing the samples edit `AdobeSignNodeJsSdk/rest-api-sample/resources/config.json` accordingly with your information.

Each sample client contains class comments that explains briefly about the action being performed.
You should edit the `config.json` configuration file to configure:  
*   Credentials (access token with the required scope)  
*   Parameters used by the samples  
*   Output path of downloaded files

There are 2 ways to run the samples :  
###### 1) Through command line  
To run all samples, use the following command : 

    ```
        node_modules/grunt/bin/grunt allSamples
    ```   
To run a specific sample, use the following command :

    ```
        node_modules/grunt/bin/grunt Sample:<SampleFileName>
    ```
For example, to run  the sample `GetSigningUrl.js`, use  

    ```
        node_modules/grunt/bin/grunt Sample:GetSigningUrl
    ```
    
###### 2) From the IDE

######  IntellijIdea
 
 Import the project  
 
1. Click File -> New -> Project from Existing Sources.
2. In the dialog that opens, select the directory which contains the collection of sources you want to import. Click OK.  
3. As a result, AdobeSignNodeJsSdk is imported.    


To run the sample,  
###### For IntellijIdea  
   Please right click on the sample, and select `Run` to run it.

**Note :** To run the sample using OAuth workflow, please go through [OAuthReadMe](https://github.com/adobe-sign/AdobeSignNodeJsSdk/tree/master/rest-api-sample/api/oAuth/server/OAuthReadMe.md).  

Tests
====================

**Note :** If you have installed the client from npm, please find the tests [here](https://github.com/adobe-sign/AdobeSignNodeJsSdk/tree/master/rest-api-sdk/test).

The test folder contains the test cases and is located at `AdobeSignNodeJsSdk/rest-api-sdk/test`.  

All sources under the test folder are laid out as follows:

**api**  
Contains individual test cases for each API under the corresponding resource folder name.

**resources**  
Contains input files used in the tests. These include a config.json file and pdf files required by some of the APIs.  

**utils**  
Contains helper classes that encapsulate the functionality required by the test classes.

**Note :** Before executing the tests, edit `AdobeSignNodeJsSdk/rest-api-sdk/test/resources/config.json` accordingly with your information.

### Executing the tests

The tests can be executed by using this command from the base directory: 
```
    node_modules/grunt/bin/grunt test
```
To run a specific test file
```
    node_modules/mocha/bin/mocha <TestFilePath>
```
For example, to run the test for CreateAgreementsApiTest.js
```
    node_modules/mocha/bin/mocha rest-api-sdk/test/api/Agreements/CreateAgreementsApiTest.js
```
The tests can also be executed by using mocha from the base directory:
```
    node_modules/mocha/bin/mocha --recursive rest-api-sdk/test/api
```

Documentation
====================
A comprehensive documentation for the APIs and the classes used can be found at `AdobeSignNodeJsSdk/docs/html/index.html`.  

License
=======
Code released under the license which can be found [here](https://github.com/adobe-sign/AdobeSignNodeJsSdk/blob/master/LICENSE).

Report Issues/Bugs
====================
You can report the issues in the issues section of the github repo.

Usage: Sample to send an agreement using transient document
===========================================================

```

(function SendAgreementUsingTransientDocument() {

  /**
   * This sample client demonstrates how to send an agreement using npm module 'adobe-sign-sdk'
   */

  var AdobeSignSdk = require('adobe-sign-sdk');
  var path = require('path');
  var fs = require('fs');
  
  var ACCESS_TOKEN = "YOUR_ACCESS_TOKEN";               //Access token to allow  the user to authorize API access  
  var DIR_NAME = "SAMPLE_DIRECTORY";                    //Path structure of directory containing the file Sample.pdf
  var FILE_NAME = "SAMPLE_PDF_FILE";                    //Name of the sample document to be used in creating a transient document.
  var RECIPIENT_EMAIL = "RECIPIENT_EMAIL";              //Email id of recipient.
  var RECIPIENT_SET_NAME = "SampleRecipientSetName";    //Name of recipient set  
  var AGREEMENT_NAME = "SampleAgreementName";           //Name of agreement
  var MIME_TYPE = "application/pdf";                    //Mime type for pdf files.

  var accessTokenKey = "accessToken";
  var mimeTypeKey = "mimeType";

  //Create a new context.
  var context = new AdobeSignSdk.Context();
  var transientDocumentsApi = new AdobeSignSdk.TransientDocumentsApi(context);
  var agreementsApi = new AdobeSignSdk.AgreementsApi(context);
  var agreementsModel = AdobeSignSdk.AgreementsModel;

  //Set header parameters
  var headerParams = {};
  headerParams[accessTokenKey] = ACCESS_TOKEN;

  //Find absolute path of the file
  var absoluteFilePath = path.join(DIR_NAME,
                                   FILE_NAME);
  var fileBytes = fs.readFileSync(absoluteFilePath);
  var buffer = new Buffer(fileBytes);

  var opts = {};
  //Set mime type of the file
  opts[mimeTypeKey] = MIME_TYPE;

  //Create trasient document
  transientDocumentsApi.createTransientDocument(headerParams,
                                                FILE_NAME,
                                                buffer,
                                                opts)
                       .then(function(transientDocumentResponse) {
                         //Get the id of the transient document.
                         var transientDocumentId = transientDocumentResponse.getTransientDocumentId();
               
                         //Create file info object using transient document id
                         var fileInfo = new agreementsModel.FileInfo();
                         fileInfo.setTransientDocumentId(transientDocumentId);
                         var fileInfos = [];
                         fileInfos.push(fileInfo);
               
                         //Set email id of recipient.`
                         var recipientEmail = RECIPIENT_EMAIL;
                         var recipientInfo = new agreementsModel.RecipientInfo();
                         recipientInfo.setEmail(recipientEmail);
               
                         //Create an array of recipients from list of email ids.
                         var recipientSetMemberInfos = [];
                         recipientSetMemberInfos.push(recipientInfo);
               
                         //Create recipient set which will receive the agreement.
                         var recipientSetInfo = new agreementsModel.RecipientSetInfo();
                         recipientSetInfo.setRecipientSetMemberInfos(recipientSetMemberInfos);
                         recipientSetInfo.setRecipientSetRole(agreementsModel.RecipientSetInfo.RecipientSetRoleEnum.SIGNER);
                         recipientSetInfo.setRecipientSetName(RECIPIENT_SET_NAME);
               
                         //Set recipient set infos
                         var recipientSetInfos = [];
                         recipientSetInfos.push(recipientSetInfo);
               
                         //Create document creation info.
                         var documentCreationInfo = new agreementsModel.DocumentCreationInfo();
                         documentCreationInfo.setName(AGREEMENT_NAME);
                         documentCreationInfo.setFileInfos(fileInfos);
                         documentCreationInfo.setRecipientSetInfos(recipientSetInfos);
                         documentCreationInfo.setSignatureType(agreementsModel.DocumentCreationInfo.SignatureTypeEnum.ESIGN);
                         documentCreationInfo.setSignatureFlow(agreementsModel.DocumentCreationInfo.SignatureFlowEnum.SENDER_SIGNATURE_NOT_REQUIRED);
               
                         //Create agreement creation info.
                         var agreementCreationInfo = new agreementsModel.AgreementCreationInfo();
                         agreementCreationInfo.setDocumentCreationInfo(documentCreationInfo);
               
                         //Create agreement using the transient document.
                         return agreementsApi.createAgreement(headerParams,
                                                              agreementCreationInfo);
                       })
                       .then(function(agreementCreationResponse) {
                         //Get agreement info using the agreement id.
                         return agreementsApi.getAgreementInfo(headerParams,
                                                               agreementCreationResponse.getAgreementId());
                       })
                       .then(function(agreementInfo) {
                         //Display agreement details
                         console.log("Agreement ID = " + agreementInfo.getAgreementId());
                         console.log("Agreement Name = " + agreementInfo.getName());
                         console.log("Agreement Status = " + agreementInfo.getStatus());
                       })
                       .catch(function(apiError) {
                         console.log(apiError)
                       });
               
})();


```
